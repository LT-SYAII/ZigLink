<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZigLink - High Performance Shortener</title>
    <meta name="description" content="ZigLink helps you create simple, memorable, and powerful short links for your brand or personal use. Share your content with confidence using our easy-to-use link management tool.">
    <meta name="keywords" content="short link, custom alias, link management, easy sharing, social media tools, custom url">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Bang Syaii">
    <link rel="canonical" href="https://ziglink.syaii.sbs">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ZigLink - Simple & Powerful URL Shortener">
    <meta property="og:description" content="Simplify your links and amplify your reach. Create custom short links in seconds with ZigLink.">
    <meta property="og:image" content="https://ziglink.syaii.sbs/og-image.png">
    <meta property="og:url" content="https://ziglink.syaii.sbs">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;800&family=Space+Grotesk:wght@700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "ZigLink",
      "url": "https://ziglink.syaii.sbs",
      "description": "Ultra-fast URL shortener powered by Zig. Create custom, reliable, and lightning-fast short links.",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "author": {
        "@type": "Person",
        "name": "Bang Syaii",
        "url": "https://bang.syaii.sbs"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
    <style>
        :root {
            --bg: #09090b;
            --card: #121214;
            --input: #1c1c1f;
            --border: #27272a;
            --text: #f4f4f5;
            --text-muted: #71717a;
            --primary: #f97316;
            --primary-glow: rgba(249, 115, 22, 0.15);
            --success: #10b981;
            /* Cartoon Physics */
            --bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        html, body { min-height: 100vh; margin: 0; }
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg); color: var(--text);
            display: flex; flex-direction: column;
        }
        .container { 
            width: 100%; 
            max-width: 1600px; 
            margin: 0 auto; 
            padding: clamp(1rem, 3vw, 2rem); 
            flex: 1; display: flex; flex-direction: column;
        }
        /* HEADER */
        header {
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center;
            padding: 20px 0; border-bottom: 1px solid var(--border); margin-bottom: clamp(20px, 5vw, 60px);
            background: rgba(9,9,11,0.8); backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 50; gap: 15px;
            animation: popIn 0.6s var(--bounce);
        }
        .brand { font-weight: 800; font-size: 24px; display: flex; align-items: center; gap: 10px; transition: transform 0.3s var(--bounce); }
        .brand:hover { transform: scale(1.1) rotate(2deg); }
        .brand i { color: var(--primary); font-size: 32px; transition: transform 0.5s var(--bounce); }
        .brand:hover i { transform: rotate(45deg); }
        .header-actions { display: flex; align-items: center; gap: 20px; }
        .btn-donate {
            background: var(--primary); color: white; border: none; padding: 10px 20px;
            border-radius: 8px; font-weight: 700; text-decoration: none; font-size: 13px;
            display: flex; align-items: center; gap: 6px; transition: all 0.3s var(--bounce);
        }
        .btn-donate:hover { transform: translateY(-5px) scale(1.1); box-shadow: 0 10px 0 #c2410c; }
        .btn-donate:active { transform: translateY(0) scale(0.95); box-shadow: 0 0 0; }
        /* LAYOUT ANIMATION */
        .main-layout {
            display: flex; flex-wrap: wrap; gap: clamp(30px, 5vw, 80px); align-items: start;
        }
        .left-panel { 
            flex: 999 1 500px; min-width: 300px; 
            display: flex; flex-direction: column; gap: 40px;
            animation: slideInRight 0.8s var(--bounce) 0.2s backwards;
        }
        .right-panel {
            flex: 1 1 350px; min-width: 300px;
            position: sticky; top: 100px;
            animation: slideInLeft 0.8s var(--bounce) 0.4s backwards;
        }
        /* HERO */
        .hero-section { text-align: center; display: flex; flex-direction: column; align-items: center; margin-bottom: 20px; }
        .hero-top {
            font-family: 'Space Grotesk', sans-serif; font-weight: 900;
            font-size: clamp(40px, 8vw, 96px); line-height: 0.9;
            color: transparent; -webkit-text-stroke: 2px rgba(255,255,255,0.8);
            letter-spacing: -2px; margin-bottom: 10px;
            transition: 0.3s var(--bounce);
        }
        .hero-section:hover .hero-top { transform: scale(1.05); -webkit-text-stroke: 3px var(--primary); }
        .hero-bottom {
            background: var(--primary); color: black;
            font-family: 'JetBrains Mono', monospace; font-weight: 800;
            font-size: clamp(40px, 8vw, 96px); line-height: 1;
            padding: 5px 30px; border: 4px solid white;
            transform: rotate(-3deg);
            box-shadow: 10px 10px 0px 0px rgba(255,255,255,0.2);
            transition: 0.4s var(--bounce);
        }
        .hero-bottom:hover { transform: rotate(3deg) scale(1.1); box-shadow: 15px 15px 0px 0px var(--primary); }
        /* CREATION CARD */
        .creation-card {
            background: var(--card); border: 2px solid var(--border);
            border-radius: 24px; padding: clamp(20px, 4vw, 40px);
            display: flex; flex-direction: column; gap: 24px;
            box-shadow: 8px 8px 0px 0px #000;
            transition: transform 0.3s var(--bounce), box-shadow 0.3s;
        }
        .creation-card:hover { transform: translate(-4px, -4px); box-shadow: 12px 12px 0px 0px var(--primary); border-color: var(--primary); }
        .field-group { display: flex; flex-direction: column; gap: 10px; flex: 1; }
        .field-group label { font-size: 13px; font-weight: 700; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        input {
            background: var(--input); border: 2px solid var(--border); color: white;
            padding: 18px 20px; font-size: 16px; border-radius: 12px;
            font-family: inherit; width: 100%; transition: all 0.3s var(--bounce);
        }
        input:focus { border-color: var(--primary); transform: scale(1.02); box-shadow: 6px 6px 0px 0px rgba(249, 115, 22, 0.5); }
        .bottom-row { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-end; }
        .bottom-row .field-group { flex: 1 1 200px; }
        .btn-submit {
            background: var(--primary); color: white; border: none;
            height: 60px; padding: 0 40px; border-radius: 12px; font-weight: 800; font-size: 16px;
            cursor: pointer; transition: all 0.3s var(--bounce); white-space: nowrap;
            display: flex; align-items: center; justify-content: center; gap: 10px; flex: 1 1 150px;
            box-shadow: 0 5px 0 #c2410c;
        }
        .btn-submit:hover { transform: translateY(-5px) scale(1.02); filter: brightness(1.1); box-shadow: 0 10px 0 #c2410c; }
        .btn-submit:active { transform: translateY(0); box-shadow: 0 0 0; }
        /* RESULT BOX */
        #resultContainer {
            display: none; background: #1a1a1d; border: 2px solid var(--primary);
            padding: 24px; border-radius: 16px; margin-top: 20px;
            box-shadow: 8px 8px 0px 0px var(--primary);
            animation: popIn 0.6s var(--bounce);
        }
        .result-link { font-family: 'JetBrains Mono', monospace; font-size: clamp(18px, 3vw, 24px); font-weight: 700; color: white; text-decoration: none; word-break: break-all; transition: 0.3s var(--bounce); }
        .result-link:hover { color: var(--primary); transform: scale(1.05) rotate(-1deg); display: inline-block; }
        /* HISTORY */
        .history-section { 
            background: var(--card); border: 1px solid var(--border);
            border-radius: 24px; padding: 24px;
            transition: 0.3s;
        }
        #linkList {
            min-height: 380px; /* Consistently sized for 4 items */
            display: flex;
            flex-direction: column;
        }
        .history-section:hover { border-color: #444; }
        .history-title { 
            font-size: 16px; font-weight: 800; color: white; text-transform: uppercase; 
            margin-bottom: 20px; display: flex; align-items: center; justify-content: space-between; gap: 10px;
            padding-bottom: 15px; border-bottom: 1px solid var(--border);
        }
        .count-badge { background: var(--primary); padding: 4px 12px; border-radius: 20px; font-size: 12px; color: black; font-weight: 800; transform: rotate(5deg); }
        /* ITEM ANIMATION */
        @keyframes popInItem {
            0% { opacity: 0; transform: scale(0.5) translateY(50px); }
            70% { opacity: 1; transform: scale(1.05) translateY(-10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        .link-item {
            background: #0c0c0e; border: 1px solid var(--border);
            border-radius: 12px; padding: 16px; margin-bottom: 12px;
            display: flex; flex-direction: column; gap: 10px; 
            transition: all 0.3s var(--bounce);
            opacity: 0; animation: popInItem 0.6s var(--bounce) forwards;
        }
        .link-item:hover { border-color: var(--primary); background: #151518; transform: scale(1.03) rotate(-1deg); box-shadow: 5px 5px 0 0 rgba(249, 115, 22, 0.3); }
        .link-row-top { display: flex; justify-content: space-between; align-items: center; }
        .short-code { color: var(--primary); font-weight: 700; font-family: 'JetBrains Mono'; font-size: 16px; text-decoration: none; }
        .long-url { color: #555; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
        .btn-icon {
            width: 36px; height: 36px; border-radius: 8px; border: 1px solid var(--border);
            background: var(--input); color: var(--text-muted); cursor: pointer;
            display: flex; align-items: center; justify-content: center; transition: 0.3s var(--bounce);
        }
        .btn-icon:hover { color: white; border-color: #666; background: #333; transform: rotate(15deg) scale(1.2); }
        /* PAGINATION */
        .pagination {
            display: flex; justify-content: space-between; align-items: center;
            margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border);
        }
        .btn-page {
            background: var(--input); color: white; border: 1px solid var(--border);
            padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600;
            transition: 0.3s var(--bounce);
        }
        .btn-page:hover:not(:disabled) { border-color: var(--primary); color: var(--primary); transform: translateY(-3px); box-shadow: 0 5px 0 #333; }
        .btn-page:active { transform: translateY(0); box-shadow: 0 0 0; }
        .btn-page:disabled { opacity: 0.5; cursor: not-allowed; }
        .page-info { font-size: 12px; color: var(--text-muted); font-family: 'JetBrains Mono'; }
        /* SECTIONS */
        .section-title { text-align: center; font-size: 24px; font-weight: 800; margin: 80px 0 40px 0; letter-spacing: -0.5px; opacity: 0; animation: popIn 0.8s var(--bounce) 0.4s forwards; }
        .steps-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; width: 100%;
            opacity: 0; animation: popIn 0.8s var(--bounce) 0.5s forwards;
        }
        .step-card {
            background: var(--card); border: 2px solid var(--border); padding: 30px; border-radius: 20px;
            text-align: center; transition: 0.3s var(--bounce); position: relative; overflow: hidden;
            box-shadow: 6px 6px 0 0 #000;
        }
        .step-card:hover { border-color: var(--primary); transform: translateY(-10px) rotate(2deg); box-shadow: 10px 10px 0 0 var(--primary); }
        .step-card i { font-size: 40px; color: var(--primary); margin-bottom: 20px; display: block; transition: 0.3s var(--bounce); }
        .step-card:hover i { transform: scale(1.5) rotate(-10deg); }
        .step-card h4 { margin: 0 0 10px 0; font-size: 18px; color: white; }
        .step-card p { margin: 0; font-size: 14px; color: var(--text-muted); line-height: 1.6; }
        .cta-section {
            background: linear-gradient(145deg, var(--card), #18181b);
            border: 2px solid var(--border); padding: clamp(40px, 5vw, 80px) 20px; border-radius: 30px;
            text-align: center; margin: 80px 0; width: 100%;
            opacity: 0; animation: popIn 0.8s var(--bounce) 0.6s forwards;
            transition: 0.3s var(--bounce); box-shadow: 8px 8px 0 0 #000;
        }
        .cta-section:hover { box-shadow: 15px 15px 0 rgba(249, 115, 22, 0.2); border-color: var(--primary); transform: scale(1.02); }
        .btn-cta {
            background: white; color: black; border: none; padding: 15px 40px;
            border-radius: 12px; font-weight: 800; font-size: 16px; cursor: pointer; margin-top: 20px;
            transition: 0.3s var(--bounce); box-shadow: 0 5px 0 #ccc;
        }
        .btn-cta:hover { transform: translateY(-5px) scale(1.05) rotate(-2deg); box-shadow: 0 10px 0 var(--primary); }
        .btn-cta:active { transform: translateY(0); box-shadow: 0 0 0; }
        footer { margin-top: auto; text-align: center; padding: 40px; border-top: 1px solid var(--border); color: var(--text-muted); opacity: 0; animation: popIn 0.8s var(--bounce) 0.7s forwards; }
        footer a { color: var(--text); text-decoration: none; font-weight: 700; transition: 0.2s; }
        footer a:hover { color: var(--primary); }
        @keyframes popIn { 
            0% { opacity: 0; transform: scale(0.5); } 
            70% { opacity: 1; transform: scale(1.05); } 
            100% { opacity: 1; transform: scale(1); } 
        }
        @keyframes slideInRight { from { opacity: 0; transform: translateX(-50px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }
        #qrModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 999; }
        #qrModal.show { opacity: 1; pointer-events: all; }
        .modal-content { background: var(--card); padding: 32px; border-radius: 24px; border: 2px solid var(--border); text-align: center; max-width: 90%; transform: scale(0.5); transition: 0.4s var(--bounce); box-shadow: 10px 10px 0 0 #000; }
        #qrModal.show .modal-content { transform: scale(1); }
        #toast { position: fixed; bottom: 30px; left: 50%; transform: translate(-50%, 100px); background: white; color: black; padding: 12px 28px; border-radius: 12px; font-weight: 700; opacity: 0; transition: 0.4s var(--bounce); z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 2px solid black; }
        #toast.show { transform: translate(-50%, 0) rotate(-2deg); opacity: 1; }
        #toast.error { background: #ef4444; color: white; border-color: #ef4444; transform: translate(-50%, 0) rotate(2deg); }
    </style>
</head>
<body>
<header>
    <div class="brand"><i class="ph-fill ph-lightning"></i> ZigLink</div>
    <div class="header-actions">
        <a href="https://saweria.co/bgsyaii" target="_blank" class="btn-donate">
            <i class="ph-fill ph-coffee"></i> Donate
        </a>
    </div>
</header>
<div class="container">
    <div class="main-layout">
        <div class="left-panel">
            <div class="hero-section">
                <div class="hero-top">READY FOR</div>
                <div class="hero-bottom">SHORTEN??</div>
            </div>
            <div class="creation-card">
                <div class="field-group">
                    <label>Destination URL</label>
                    <input type="url" id="urlInput" placeholder="https://example.com/long-link..." required>
                </div>
                <div class="bottom-row">
                    <div class="field-group">
                        <label>Custom Alias (Opt)</label>
                        <input type="text" id="aliasInput" placeholder="e.g. my-link">
                    </div>
                    <button class="btn-submit" onclick="createLink()" id="btnCreate">
                        <i class="ph-bold ph-magic-wand"></i> Shorten
                    </button>
                </div>
            </div>
            <div id="resultContainer">
                <div style="font-size:12px; font-weight:800; color:var(--primary); text-transform:uppercase; margin-bottom:15px;">Your link is ready!</div>
                <div class="result-content">
                    <a href="#" id="resultLink" target="_blank" class="result-link">/link</a>
                    <div style="display:flex; gap:10px">
                        <button class="btn-icon" id="btnResQr" style="width:48px;height:48px;"><i class="ph-bold ph-qr-code" style="font-size:20px;"></i></button>
                        <button class="btn-icon" id="btnResCopy" style="width:48px;height:48px;"><i class="ph-bold ph-copy" style="font-size:20px;"></i></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="right-panel">
            <div class="history-section">
                <div class="history-title">
                    <span><i class="ph-bold ph-clock-counter-clockwise"></i> Recent Activity</span>
                    <span id="totalLinks" class="count-badge">0</span>
                </div>
                <div id="linkList"></div>
                <div class="pagination" id="paginationControls" style="display:none">
                    <button onclick="prevPage()" class="btn-page" id="btnPrev"><i class="ph-bold ph-caret-left"></i></button>
                    <span class="page-info" id="pageInfo">Page 1</span>
                    <button onclick="nextPage()" class="btn-page" id="btnNext"><i class="ph-bold ph-caret-right"></i></button>
                </div>
            </div>
        </div>
    </div>
    <h3 class="section-title">How It Works</h3>
    <div class="steps-grid">
        <div class="step-card">
            <i class="ph-fill ph-link"></i>
            <h4>Paste Link</h4>
            <p>Enter the long URL you want to shorten in the box above.</p>
        </div>
        <div class="step-card">
            <i class="ph-fill ph-pencil-simple"></i>
            <h4>Customize</h4>
            <p>Add a custom alias to make your link memorable and unique.</p>
        </div>
        <div class="step-card">
            <i class="ph-fill ph-share-network"></i>
            <h4>Share It</h4>
            <p>Copy your new short link or generate a QR code instantly.</p>
        </div>
    </div>
    <div class="cta-section">
        <h2>Start Shortening Now</h2>
        <p>Join thousands of users creating optimized links with ZigLink.</p>
        <button onclick="document.getElementById('urlInput').focus()" class="btn-cta">Get Started Free</button>
    </div>
    <footer>
        <div class="footer-donate">
            <p style="margin-bottom:10px">Support the developer:</p>
            <a href="https://saweria.co/bgsyaii" target="_blank" class="btn-donate" style="display:inline-flex; margin-top:10px;">
                <i class="ph-fill ph-heart"></i> Saweria
            </a>
        </div>
        <p style="margin-top:30px">&copy; <span id="currentYear"></span> ZigLink. Created by <a href="https://bang.syaii.sbs" target="_blank">Bang Syaii</a>. Built with Zig.</p>
    </footer>
</div>
<div id="qrModal" onclick="closeQr()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div id="qrcode" style="padding:15px; background:white; border-radius:12px; display:inline-block;"></div>
        <button onclick="closeQr()" style="margin-top:20px; width:100%; padding:10px; border-radius:8px; border:none; background:#333; color:white; cursor:pointer; font-weight:700;">CLOSE</button>
    </div>
</div>
<div id="toast">Success</div>
<script>
    const API_URL = window.location.origin;
    // Pagination State
    let allLinks = [];
    let currentPage = 1;
    const itemsPerPage = 4; // UPDATED to 4
    // SILENT AUTH HANDSHAKE
    fetch('/auth/verify', { method: 'POST' }).then(() => {
        console.log("Secure connection established.");
        refreshData();
    }).catch(e => console.log("Auth failed", e));
    function showToast(msg, type = "success") {
        const t = document.getElementById('toast');
        t.innerText = msg;
        t.className = type === "error" ? "show error" : "show";
        setTimeout(() => t.className = '', 2000);
    }
    function showQr(url) {
        const modal = document.getElementById('qrModal');
        const container = document.getElementById('qrcode');
        container.innerHTML = ''; 
        new QRCode(container, { text: url, width: 200, height: 200 });
        modal.classList.add('show');
    }
    function closeQr() { document.getElementById('qrModal').classList.remove('show'); }
    async function refreshData() {
        try {
            const res = await fetch(API_URL + '/info');
            const json = await res.json();
            const el = document.getElementById('totalLinks');
            if(el) el.innerText = json.total_links || 0;
            // Store data globally
            allLinks = json.data || [];
            // Render First Page
            renderTable();
        } catch (e) { console.log(e); }
    }
    function renderTable() {
        const list = document.getElementById('linkList');
        const controls = document.getElementById('paginationControls');
        if(allLinks.length === 0) {
            list.innerHTML = '<div style="flex:1; display:flex; align-items:center; justify-content:center; color:#333; font-size:13px;">No history yet.</div>';
            controls.style.display = 'none';
            return;
        }
        // Slice Data
        const reversed = [...allLinks].reverse();
        const start = (currentPage - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        const pageData = reversed.slice(start, end);
        const totalPages = Math.ceil(reversed.length / itemsPerPage);
        // Render List with Staggered Animation
        let html = '';
        pageData.forEach((item, index) => {
            const short = `${API_URL}/${item.code}`;
            // Stagger delay calculation
            const delay = index * 0.1;
            html += `
            <div class="link-item" style="animation-delay: ${delay}s">
                <div class="link-row-top">
                    <a href="${short}" target="_blank" class="short-code">/${item.code}</a>
                    <button class="btn-icon" onclick="copyText('${short}', this)"><i class="ph-bold ph-copy"></i></button>
                </div>
                <div class="long-url">${item.url}</div>
            </div>`;
        });
        list.innerHTML = html;
        // Update Pagination Controls
        if (totalPages > 1) {
            controls.style.display = 'flex';
            document.getElementById('pageInfo').innerText = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('btnPrev').disabled = currentPage === 1;
            document.getElementById('btnNext').disabled = currentPage >= totalPages;
        } else {
            controls.style.display = 'none';
        }
    }
    function nextPage() {
        currentPage++;
        renderTable();
    }
    function prevPage() {
        if(currentPage > 1) {
            currentPage--;
            renderTable();
        }
    }
    async function createLink() {
        const urlInput = document.getElementById('urlInput');
        const aliasInput = document.getElementById('aliasInput');
        let url = urlInput.value.trim();
        const alias = aliasInput.value.trim();
        if(!url) return showToast("URL is required!", "error");
        if (!url.startsWith('http://') && !url.startsWith('https://')) {
            url = 'https://' + url;
        }
        try {
            const check = new URL(url);
            if(check.hostname === window.location.hostname) {
                return showToast("Cannot shorten internal links!", "error");
            }
        } catch(e) {
            return showToast("Invalid URL format!", "error");
        }
        const btn = document.getElementById('btnCreate');
        btn.disabled = true; btn.innerHTML = '<i class="ph ph-spinner-gap" style="animation:spin 1s linear infinite"></i>';
        try {
            const res = await fetch(API_URL + '/api/shorten', {
                method: 'POST',
                body: JSON.stringify({ url, alias })
            });
            const d = await res.json();
            if(res.ok) {
                const fullUrl = `${API_URL}/${d.short_code}`;
                const resBox = document.getElementById('resultContainer');
                document.getElementById('resultLink').href = fullUrl;
                document.getElementById('resultLink').innerText = window.location.host + "/" + d.short_code;
                document.getElementById('btnResCopy').onclick = () => copyText(fullUrl, document.getElementById('btnResCopy'));
                document.getElementById('btnResQr').onclick = () => showQr(fullUrl);
                resBox.style.display = 'block';
                urlInput.value = ''; aliasInput.value = '';
                showToast("Shortlink created!");
                // Reset to page 1 to show new link
                currentPage = 1;
                refreshData();
            } else showToast(d.error || "Failed", "error");
        } catch (e) { showToast("Connection error", "error"); }
        btn.disabled = false; btn.innerHTML = '<i class="ph-bold ph-magic-wand"></i> Shorten';
    }
    function copyText(text, btn) {
        const icon = btn.querySelector('i');
        const doCopy = () => {
            showToast("Copied!");
            icon.className = 'ph-bold ph-check';
            setTimeout(() => icon.className = 'ph-bold ph-copy', 1500);
        };
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(text).then(doCopy).catch(() => fallbackCopy(text, doCopy));
        } else fallbackCopy(text, doCopy);
    }
    function fallbackCopy(text, cb) {
        const t = document.createElement("textarea"); t.value = text;
        t.style.position="fixed"; t.style.left="-9999px"; document.body.appendChild(t);
        t.focus(); t.select();
        try { document.execCommand('copy'); cb(); } catch(e) {}
        document.body.removeChild(t);
    }
    document.getElementById('currentYear').innerText = new Date().getFullYear();
    // Auto refresh
    setInterval(refreshData, 5000);
</script>
</body>
</html>